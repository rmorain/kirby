---

title: Basic Model


keywords: fastai
sidebar: home_sidebar

summary: "A basic Pytorch lighting module"
description: "A basic Pytorch lighting module"
nb_path: "06_basic_model.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 06_basic_model.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BasicModel" class="doc_header"><code>class</code> <code>BasicModel</code><a href="https://github.com/rmorain/kirby/tree/master/kirby/basic_model.py#L14" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BasicModel</code>(<strong><code>run_params</code></strong>) :: <code>LightningModule</code></p>
</blockquote>
<p>Helper class that provides a standard way to create an ABC using
inheritance.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Testing">Testing<a class="anchor-link" href="#Testing"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">basic_model</span> <span class="o">=</span> <span class="n">BasicModel</span><span class="p">(</span><span class="n">RunParams</span><span class="p">())</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">basic_model</span><span class="p">,</span> <span class="n">BasicModel</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">run_params</span> <span class="o">=</span> <span class="n">RunParams</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">basic_model</span> <span class="o">=</span> <span class="n">BasicModel</span><span class="p">(</span><span class="n">run_params</span><span class="p">)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Trainer</span><span class="p">(</span>
    <span class="n">default_root_dir</span><span class="o">=</span><span class="s1">&#39;logs&#39;</span><span class="p">,</span>
    <span class="n">gpus</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">max_epochs</span><span class="o">=</span><span class="n">run_params</span><span class="o">.</span><span class="n">max_epochs</span><span class="p">,</span>
    <span class="n">fast_dev_run</span><span class="o">=</span><span class="n">run_params</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span>
    <span class="n">logger</span><span class="o">=</span><span class="n">TensorBoardLogger</span><span class="p">(</span><span class="n">save_dir</span><span class="o">=</span><span class="s1">&#39;logs/&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">run_params</span><span class="o">.</span><span class="n">run_name</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">basic_model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>GPU available: False, used: False
TPU available: None, using: 0 TPU cores
Using custom data configuration default
Reusing dataset text (/root/.cache/huggingface/datasets/text/default-04bff418a63932f2/0.0.0/daf90a707a433ac193b369c8cc1772139bb6cca21a9c7fe83bdd16aad9b9b6ab)
Loading cached processed dataset at /root/.cache/huggingface/datasets/text/default-04bff418a63932f2/0.0.0/daf90a707a433ac193b369c8cc1772139bb6cca21a9c7fe83bdd16aad9b9b6ab/cache-24893c4c19715a92.arrow
Using custom data configuration default
Reusing dataset text (/root/.cache/huggingface/datasets/text/default-04bff418a63932f2/0.0.0/daf90a707a433ac193b369c8cc1772139bb6cca21a9c7fe83bdd16aad9b9b6ab)
Loading cached processed dataset at /root/.cache/huggingface/datasets/text/default-04bff418a63932f2/0.0.0/daf90a707a433ac193b369c8cc1772139bb6cca21a9c7fe83bdd16aad9b9b6ab/cache-8bb82f4eaed17d4f.arrow

  | Name  | Type             | Params
-------------------------------------------
0 | model | GPT2LMHeadModel  | 124 M 
1 | loss  | CrossEntropyLoss | 0     
-------------------------------------------
124 M     Trainable params
0         Non-trainable params
124 M     Total params
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(51)<span class="ansi-cyan-fg">val_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     49 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> val_dataloader<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     50 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">import</span> pdb<span class="ansi-blue-fg">;</span> pdb<span class="ansi-blue-fg">.</span>set_trace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 51 </span><span class="ansi-red-fg">        return torch.utils.data.DataLoader(
</span><span class="ansi-green-fg">     52 </span><span class="ansi-red-fg">                </span>self<span class="ansi-blue-fg">.</span>val_ds<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     53 </span><span class="ansi-red-fg">                </span>batch_size<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>run_params<span class="ansi-blue-fg">.</span>batch_size<span class="ansi-blue-fg">,</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;torch.utils.data.dataloader.DataLoader object at 0x7f4db12e3460&gt;
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(52)<span class="ansi-cyan-fg">val_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     50 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">import</span> pdb<span class="ansi-blue-fg">;</span> pdb<span class="ansi-blue-fg">.</span>set_trace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     51 </span><span class="ansi-red-fg">        return torch.utils.data.DataLoader(
</span><span class="ansi-green-fg">---&gt; 52 </span><span class="ansi-red-fg">                </span>self<span class="ansi-blue-fg">.</span>val_ds<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     53 </span><span class="ansi-red-fg">                </span>batch_size<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>run_params<span class="ansi-blue-fg">.</span>batch_size<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     54 </span><span class="ansi-red-fg">                </span>drop_last<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(53)<span class="ansi-cyan-fg">val_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     51 </span><span class="ansi-red-fg">        return torch.utils.data.DataLoader(
</span><span class="ansi-green-fg">     52 </span><span class="ansi-red-fg">                </span>self<span class="ansi-blue-fg">.</span>val_ds<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">---&gt; 53 </span><span class="ansi-red-fg">                </span>batch_size<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>run_params<span class="ansi-blue-fg">.</span>batch_size<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     54 </span><span class="ansi-red-fg">                </span>drop_last<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     55 </span><span class="ansi-red-fg">                </span>shuffle<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(54)<span class="ansi-cyan-fg">val_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     52 </span><span class="ansi-red-fg">                </span>self<span class="ansi-blue-fg">.</span>val_ds<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     53 </span><span class="ansi-red-fg">                </span>batch_size<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>run_params<span class="ansi-blue-fg">.</span>batch_size<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">---&gt; 54 </span><span class="ansi-red-fg">                </span>drop_last<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     55 </span><span class="ansi-red-fg">                </span>shuffle<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     56 </span><span class="ansi-red-fg">                </span>num_workers<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>run_params<span class="ansi-blue-fg">.</span>num_workers<span class="ansi-blue-fg">,</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(55)<span class="ansi-cyan-fg">val_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     53 </span><span class="ansi-red-fg">                </span>batch_size<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>run_params<span class="ansi-blue-fg">.</span>batch_size<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     54 </span><span class="ansi-red-fg">                </span>drop_last<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">---&gt; 55 </span><span class="ansi-red-fg">                </span>shuffle<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     56 </span><span class="ansi-red-fg">                </span>num_workers<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>run_params<span class="ansi-blue-fg">.</span>num_workers<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     57 </span><span class="ansi-red-fg">                </span>pin_memory<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(56)<span class="ansi-cyan-fg">val_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     54 </span><span class="ansi-red-fg">                </span>drop_last<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     55 </span><span class="ansi-red-fg">                </span>shuffle<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">---&gt; 56 </span><span class="ansi-red-fg">                </span>num_workers<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>run_params<span class="ansi-blue-fg">.</span>num_workers<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     57 </span><span class="ansi-red-fg">                </span>pin_memory<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span>
<span class="ansi-green-fg">     58 </span><span class="ansi-red-fg">                )
</span>
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(57)<span class="ansi-cyan-fg">val_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     55 </span><span class="ansi-red-fg">                </span>shuffle<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     56 </span><span class="ansi-red-fg">                </span>num_workers<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>run_params<span class="ansi-blue-fg">.</span>num_workers<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">---&gt; 57 </span><span class="ansi-red-fg">                </span>pin_memory<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span>
<span class="ansi-green-fg">     58 </span><span class="ansi-red-fg">                )
</span><span class="ansi-green-fg">     59 </span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(51)<span class="ansi-cyan-fg">val_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     49 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> val_dataloader<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     50 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">import</span> pdb<span class="ansi-blue-fg">;</span> pdb<span class="ansi-blue-fg">.</span>set_trace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 51 </span><span class="ansi-red-fg">        return torch.utils.data.DataLoader(
</span><span class="ansi-green-fg">     52 </span><span class="ansi-red-fg">                </span>self<span class="ansi-blue-fg">.</span>val_ds<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     53 </span><span class="ansi-red-fg">                </span>batch_size<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>run_params<span class="ansi-blue-fg">.</span>batch_size<span class="ansi-blue-fg">,</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--Call--
&gt; <span class="ansi-green-fg">/usr/lib/python3.8/typing.py</span>(868)<span class="ansi-cyan-fg">__new__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    866 </span><span class="ansi-red-fg">    </span>_is_protocol <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span>
<span class="ansi-green-fg">    867 </span>
<span class="ansi-green-fg">--&gt; 868 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> __new__<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwds<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    869 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> cls <span class="ansi-green-fg">in</span> <span class="ansi-blue-fg">(</span>Generic<span class="ansi-blue-fg">,</span> Protocol<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    870 </span><span class="ansi-red-fg">            raise TypeError(f&#34;Type {cls.__name__} cannot be instantiated; &#34;
</span>
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/lib/python3.8/typing.py</span>(869)<span class="ansi-cyan-fg">__new__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    867 </span>
<span class="ansi-green-fg">    868 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> __new__<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwds<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 869 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> cls <span class="ansi-green-fg">in</span> <span class="ansi-blue-fg">(</span>Generic<span class="ansi-blue-fg">,</span> Protocol<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    870 </span><span class="ansi-red-fg">            raise TypeError(f&#34;Type {cls.__name__} cannot be instantiated; &#34;
</span><span class="ansi-green-fg">    871 </span><span class="ansi-red-fg">                            &#34;it can be used only as a base class&#34;)
</span>
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/lib/python3.8/typing.py</span>(872)<span class="ansi-cyan-fg">__new__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    870 </span><span class="ansi-red-fg">            raise TypeError(f&#34;Type {cls.__name__} cannot be instantiated; &#34;
</span><span class="ansi-green-fg">    871 </span><span class="ansi-red-fg">                            &#34;it can be used only as a base class&#34;)
</span><span class="ansi-green-fg">--&gt; 872 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__new__ <span class="ansi-green-fg">is</span> object<span class="ansi-blue-fg">.</span>__new__ <span class="ansi-green-fg">and</span> cls<span class="ansi-blue-fg">.</span>__init__ <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> object<span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    873 </span><span class="ansi-red-fg">            </span>obj <span class="ansi-blue-fg">=</span> super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__new__<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    874 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(51)<span class="ansi-cyan-fg">val_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     49 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> val_dataloader<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     50 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">import</span> pdb<span class="ansi-blue-fg">;</span> pdb<span class="ansi-blue-fg">.</span>set_trace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 51 </span><span class="ansi-red-fg">        return torch.utils.data.DataLoader(
</span><span class="ansi-green-fg">     52 </span><span class="ansi-red-fg">                </span>self<span class="ansi-blue-fg">.</span>val_ds<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     53 </span><span class="ansi-red-fg">                </span>batch_size<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>run_params<span class="ansi-blue-fg">.</span>batch_size<span class="ansi-blue-fg">,</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/lib/python3.8/typing.py</span>(873)<span class="ansi-cyan-fg">__new__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    871 </span><span class="ansi-red-fg">                            &#34;it can be used only as a base class&#34;)
</span><span class="ansi-green-fg">    872 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__new__ <span class="ansi-green-fg">is</span> object<span class="ansi-blue-fg">.</span>__new__ <span class="ansi-green-fg">and</span> cls<span class="ansi-blue-fg">.</span>__init__ <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> object<span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 873 </span><span class="ansi-red-fg">            </span>obj <span class="ansi-blue-fg">=</span> super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__new__<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    874 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    875 </span><span class="ansi-red-fg">            </span>obj <span class="ansi-blue-fg">=</span> super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__new__<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwds<span class="ansi-blue-fg">)</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/lib/python3.8/typing.py</span>(876)<span class="ansi-cyan-fg">__new__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    874 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    875 </span><span class="ansi-red-fg">            </span>obj <span class="ansi-blue-fg">=</span> super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__new__<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwds<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 876 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> obj
<span class="ansi-green-fg">    877 </span>
<span class="ansi-green-fg">    878 </span><span class="ansi-red-fg">    </span><span class="ansi-blue-fg">@</span>_tp_cache

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(51)<span class="ansi-cyan-fg">val_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     49 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> val_dataloader<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     50 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">import</span> pdb<span class="ansi-blue-fg">;</span> pdb<span class="ansi-blue-fg">.</span>set_trace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 51 </span><span class="ansi-red-fg">        return torch.utils.data.DataLoader(
</span><span class="ansi-green-fg">     52 </span><span class="ansi-red-fg">                </span>self<span class="ansi-blue-fg">.</span>val_ds<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     53 </span><span class="ansi-red-fg">                </span>batch_size<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>run_params<span class="ansi-blue-fg">.</span>batch_size<span class="ansi-blue-fg">,</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--Return--
&lt;torch.utils....x7f4d57382b20&gt;
&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(51)<span class="ansi-cyan-fg">val_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     49 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> val_dataloader<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     50 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">import</span> pdb<span class="ansi-blue-fg">;</span> pdb<span class="ansi-blue-fg">.</span>set_trace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 51 </span><span class="ansi-red-fg">        return torch.utils.data.DataLoader(
</span><span class="ansi-green-fg">     52 </span><span class="ansi-red-fg">                </span>self<span class="ansi-blue-fg">.</span>val_ds<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">     53 </span><span class="ansi-red-fg">                </span>batch_size<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>run_params<span class="ansi-blue-fg">.</span>batch_size<span class="ansi-blue-fg">,</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(311)<span class="ansi-cyan-fg">request_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    309 </span><span class="ansi-red-fg">        &#34;&#34;&#34;
</span><span class="ansi-green-fg">    310 </span><span class="ansi-red-fg">        </span>dataloader <span class="ansi-blue-fg">=</span> dataloader_fx<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 311 </span><span class="ansi-red-fg">        </span>dataloader <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_flatten_dl_only<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    312 </span>
<span class="ansi-green-fg">    313 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>accelerator_backend <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(313)<span class="ansi-cyan-fg">request_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    311 </span><span class="ansi-red-fg">        </span>dataloader <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_flatten_dl_only<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    312 </span>
<span class="ansi-green-fg">--&gt; 313 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>accelerator_backend <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    314 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>accelerator_backend<span class="ansi-blue-fg">.</span>barrier<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;get_dataloaders&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    315 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> dataloader

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;torch.utils.data.dataloader.DataLoader object at 0x7f4d57382b20&gt;
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(314)<span class="ansi-cyan-fg">request_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    312 </span>
<span class="ansi-green-fg">    313 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>accelerator_backend <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 314 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>accelerator_backend<span class="ansi-blue-fg">.</span>barrier<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;get_dataloaders&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    315 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> dataloader
<span class="ansi-green-fg">    316 </span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(315)<span class="ansi-cyan-fg">request_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    313 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>accelerator_backend <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    314 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>accelerator_backend<span class="ansi-blue-fg">.</span>barrier<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;get_dataloaders&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 315 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> dataloader
<span class="ansi-green-fg">    316 </span>
<span class="ansi-green-fg">    317 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> _flatten_dl_only<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> dataloaders<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--Return--
&lt;torch.utils....x7f4d57382b20&gt;
&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(315)<span class="ansi-cyan-fg">request_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    313 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>accelerator_backend <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    314 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>accelerator_backend<span class="ansi-blue-fg">.</span>barrier<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;get_dataloaders&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 315 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> dataloader
<span class="ansi-green-fg">    316 </span>
<span class="ansi-green-fg">    317 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> _flatten_dl_only<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> dataloaders<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(209)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    207 </span><span class="ansi-red-fg">        </span>dataloaders <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>request_dataloader<span class="ansi-blue-fg">(</span>getattr<span class="ansi-blue-fg">(</span>model<span class="ansi-blue-fg">,</span> loader_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    208 </span>
<span class="ansi-green-fg">--&gt; 209 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">,</span> list<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    210 </span><span class="ansi-red-fg">            </span>dataloaders <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>dataloaders<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">    211 </span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(210)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    208 </span>
<span class="ansi-green-fg">    209 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">,</span> list<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 210 </span><span class="ansi-red-fg">            </span>dataloaders <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>dataloaders<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">    211 </span>
<span class="ansi-green-fg">    212 </span><span class="ansi-red-fg">        </span><span class="ansi-red-fg"># when overfitting use the training loader as val and test</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(214)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    212 </span><span class="ansi-red-fg">        </span><span class="ansi-red-fg"># when overfitting use the training loader as val and test</span>
<span class="ansi-green-fg">    213 </span><span class="ansi-red-fg">        </span><span class="ansi-red-fg"># duplicate it the numb of times needed to match the train loaders</span>
<span class="ansi-green-fg">--&gt; 214 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>overfit_batches <span class="ansi-blue-fg">&gt;</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    215 </span><span class="ansi-red-fg">            </span>num_loaders <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    216 </span><span class="ansi-red-fg">            </span>train_dataloader <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>request_dataloader<span class="ansi-blue-fg">(</span>getattr<span class="ansi-blue-fg">(</span>model<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;train_dataloader&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(219)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    217 </span><span class="ansi-red-fg">            </span>dataloaders <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>deepcopy<span class="ansi-blue-fg">(</span>train_dataloader<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> _ <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>num_loaders<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">    218 </span>
<span class="ansi-green-fg">--&gt; 219 </span><span class="ansi-red-fg">        </span>self<span class="ansi-blue-fg">.</span>dev_debugger<span class="ansi-blue-fg">.</span>track_load_dataloader_call<span class="ansi-blue-fg">(</span>loader_name<span class="ansi-blue-fg">,</span> dataloaders<span class="ansi-blue-fg">=</span>dataloaders<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    220 </span>
<span class="ansi-green-fg">    221 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">for</span> loader_i <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>len<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(221)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    219 </span><span class="ansi-red-fg">        </span>self<span class="ansi-blue-fg">.</span>dev_debugger<span class="ansi-blue-fg">.</span>track_load_dataloader_call<span class="ansi-blue-fg">(</span>loader_name<span class="ansi-blue-fg">,</span> dataloaders<span class="ansi-blue-fg">=</span>dataloaders<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    220 </span>
<span class="ansi-green-fg">--&gt; 221 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">for</span> loader_i <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>len<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    222 </span><span class="ansi-red-fg">            </span>loader <span class="ansi-blue-fg">=</span> dataloaders<span class="ansi-blue-fg">[</span>loader_i<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">    223 </span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(222)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    220 </span>
<span class="ansi-green-fg">    221 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">for</span> loader_i <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>len<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 222 </span><span class="ansi-red-fg">            </span>loader <span class="ansi-blue-fg">=</span> dataloaders<span class="ansi-blue-fg">[</span>loader_i<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">    223 </span>
<span class="ansi-green-fg">    224 </span><span class="ansi-red-fg">            </span><span class="ansi-red-fg"># shuffling in val and test set is bad practice</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(225)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    223 </span>
<span class="ansi-green-fg">    224 </span><span class="ansi-red-fg">            </span><span class="ansi-red-fg"># shuffling in val and test set is bad practice</span>
<span class="ansi-green-fg">--&gt; 225 </span><span class="ansi-red-fg">            </span><span class="ansi-green-fg">if</span> mode <span class="ansi-green-fg">in</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;val&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;test&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">and</span> hasattr<span class="ansi-blue-fg">(</span>loader<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;sampler&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">and</span> isinstance<span class="ansi-blue-fg">(</span>loader<span class="ansi-blue-fg">.</span>sampler<span class="ansi-blue-fg">,</span> RandomSampler<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    226 </span>
<span class="ansi-green-fg">    227 </span><span class="ansi-red-fg">                </span><span class="ansi-red-fg"># when overfitting, the dataloader should not have sampler</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(221)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    219 </span><span class="ansi-red-fg">        </span>self<span class="ansi-blue-fg">.</span>dev_debugger<span class="ansi-blue-fg">.</span>track_load_dataloader_call<span class="ansi-blue-fg">(</span>loader_name<span class="ansi-blue-fg">,</span> dataloaders<span class="ansi-blue-fg">=</span>dataloaders<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    220 </span>
<span class="ansi-green-fg">--&gt; 221 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">for</span> loader_i <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>len<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    222 </span><span class="ansi-red-fg">            </span>loader <span class="ansi-blue-fg">=</span> dataloaders<span class="ansi-blue-fg">[</span>loader_i<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">    223 </span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(237)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    235 </span><span class="ansi-red-fg">                                   &#39; this off for validation and test dataloaders.&#39;)
</span><span class="ansi-green-fg">    236 </span>
<span class="ansi-green-fg">--&gt; 237 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> any<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>dl <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">for</span> dl <span class="ansi-green-fg">in</span> dataloaders<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    238 </span><span class="ansi-red-fg">            </span>rank_zero_warn<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;One of given dataloaders is None and it will be skipped.&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    239 </span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(241)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    239 </span>
<span class="ansi-green-fg">    240 </span><span class="ansi-red-fg">        </span><span class="ansi-red-fg"># add samplers</span>
<span class="ansi-green-fg">--&gt; 241 </span><span class="ansi-red-fg">        </span>dataloaders <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>auto_add_sampler<span class="ansi-blue-fg">(</span>dl<span class="ansi-blue-fg">,</span> shuffle<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> dl <span class="ansi-green-fg">in</span> dataloaders <span class="ansi-green-fg">if</span> dl <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">    242 </span>
<span class="ansi-green-fg">    243 </span><span class="ansi-red-fg">        </span>loader_num_batches <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(243)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    241 </span><span class="ansi-red-fg">        </span>dataloaders <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>auto_add_sampler<span class="ansi-blue-fg">(</span>dl<span class="ansi-blue-fg">,</span> shuffle<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> dl <span class="ansi-green-fg">in</span> dataloaders <span class="ansi-green-fg">if</span> dl <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">    242 </span>
<span class="ansi-green-fg">--&gt; 243 </span><span class="ansi-red-fg">        </span>loader_num_batches <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">    244 </span>
<span class="ansi-green-fg">    245 </span><span class="ansi-red-fg">        </span><span class="ansi-red-fg"># determine number of batches</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(247)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    245 </span><span class="ansi-red-fg">        </span><span class="ansi-red-fg"># determine number of batches</span>
<span class="ansi-green-fg">    246 </span><span class="ansi-red-fg">        </span><span class="ansi-red-fg"># datasets could be none, 1 or 2+</span>
<span class="ansi-green-fg">--&gt; 247 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">!=</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    248 </span><span class="ansi-red-fg">            </span><span class="ansi-green-fg">for</span> i<span class="ansi-blue-fg">,</span> dataloader <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    249 </span><span class="ansi-red-fg">                </span>num_batches <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> has_len<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> float<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;inf&#39;</span><span class="ansi-blue-fg">)</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(248)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    246 </span><span class="ansi-red-fg">        </span><span class="ansi-red-fg"># datasets could be none, 1 or 2+</span>
<span class="ansi-green-fg">    247 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">!=</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 248 </span><span class="ansi-red-fg">            </span><span class="ansi-green-fg">for</span> i<span class="ansi-blue-fg">,</span> dataloader <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    249 </span><span class="ansi-red-fg">                </span>num_batches <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> has_len<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> float<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;inf&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    250 </span><span class="ansi-red-fg">                </span>self<span class="ansi-blue-fg">.</span>_worker_check<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">f&#39;{mode} dataloader {i}&#39;</span><span class="ansi-blue-fg">)</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(249)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    247 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">!=</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    248 </span><span class="ansi-red-fg">            </span><span class="ansi-green-fg">for</span> i<span class="ansi-blue-fg">,</span> dataloader <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 249 </span><span class="ansi-red-fg">                </span>num_batches <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> has_len<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> float<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;inf&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    250 </span><span class="ansi-red-fg">                </span>self<span class="ansi-blue-fg">.</span>_worker_check<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">f&#39;{mode} dataloader {i}&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    251 </span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(250)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    248 </span><span class="ansi-red-fg">            </span><span class="ansi-green-fg">for</span> i<span class="ansi-blue-fg">,</span> dataloader <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    249 </span><span class="ansi-red-fg">                </span>num_batches <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> has_len<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> float<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;inf&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 250 </span><span class="ansi-red-fg">                </span>self<span class="ansi-blue-fg">.</span>_worker_check<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">f&#39;{mode} dataloader {i}&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    251 </span>
<span class="ansi-green-fg">    252 </span><span class="ansi-red-fg">                </span><span class="ansi-red-fg"># percent or num_steps</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(253)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    251 </span>
<span class="ansi-green-fg">    252 </span><span class="ansi-red-fg">                </span><span class="ansi-red-fg"># percent or num_steps</span>
<span class="ansi-green-fg">--&gt; 253 </span><span class="ansi-red-fg">                </span>limit_eval_batches <span class="ansi-blue-fg">=</span> getattr<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">f&#39;limit_{mode}_batches&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    254 </span>
<span class="ansi-green-fg">    255 </span><span class="ansi-red-fg">                </span><span class="ansi-red-fg"># limit num batches either as a percent or num steps</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(256)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    254 </span>
<span class="ansi-green-fg">    255 </span><span class="ansi-red-fg">                </span><span class="ansi-red-fg"># limit num batches either as a percent or num steps</span>
<span class="ansi-green-fg">--&gt; 256 </span><span class="ansi-red-fg">                </span><span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>limit_eval_batches<span class="ansi-blue-fg">,</span> int<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">or</span> limit_eval_batches <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">0.0</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    257 </span><span class="ansi-red-fg">                    </span>num_batches <span class="ansi-blue-fg">=</span> min<span class="ansi-blue-fg">(</span>num_batches<span class="ansi-blue-fg">,</span> int<span class="ansi-blue-fg">(</span>limit_eval_batches<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    258 </span><span class="ansi-red-fg">                </span><span class="ansi-green-fg">elif</span> num_batches <span class="ansi-blue-fg">!=</span> float<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;inf&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(258)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    256 </span><span class="ansi-red-fg">                </span><span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>limit_eval_batches<span class="ansi-blue-fg">,</span> int<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">or</span> limit_eval_batches <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">0.0</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    257 </span><span class="ansi-red-fg">                    </span>num_batches <span class="ansi-blue-fg">=</span> min<span class="ansi-blue-fg">(</span>num_batches<span class="ansi-blue-fg">,</span> int<span class="ansi-blue-fg">(</span>limit_eval_batches<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 258 </span><span class="ansi-red-fg">                </span><span class="ansi-green-fg">elif</span> num_batches <span class="ansi-blue-fg">!=</span> float<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;inf&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    259 </span><span class="ansi-red-fg">                    </span>num_batches <span class="ansi-blue-fg">=</span> int<span class="ansi-blue-fg">(</span>num_batches <span class="ansi-blue-fg">*</span> limit_eval_batches<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    260 </span><span class="ansi-red-fg">                </span><span class="ansi-green-fg">elif</span> limit_eval_batches <span class="ansi-blue-fg">!=</span> <span class="ansi-cyan-fg">1.0</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(259)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    257 </span><span class="ansi-red-fg">                    </span>num_batches <span class="ansi-blue-fg">=</span> min<span class="ansi-blue-fg">(</span>num_batches<span class="ansi-blue-fg">,</span> int<span class="ansi-blue-fg">(</span>limit_eval_batches<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    258 </span><span class="ansi-red-fg">                </span><span class="ansi-green-fg">elif</span> num_batches <span class="ansi-blue-fg">!=</span> float<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;inf&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 259 </span><span class="ansi-red-fg">                    </span>num_batches <span class="ansi-blue-fg">=</span> int<span class="ansi-blue-fg">(</span>num_batches <span class="ansi-blue-fg">*</span> limit_eval_batches<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    260 </span><span class="ansi-red-fg">                </span><span class="ansi-green-fg">elif</span> limit_eval_batches <span class="ansi-blue-fg">!=</span> <span class="ansi-cyan-fg">1.0</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    261 </span><span class="ansi-red-fg">                    raise MisconfigurationException(
</span>
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(266)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    264 </span><span class="ansi-red-fg">                        f&#39; `num_{mode}_batches` to use.&#39;)
</span><span class="ansi-green-fg">    265 </span>
<span class="ansi-green-fg">--&gt; 266 </span><span class="ansi-red-fg">                </span><span class="ansi-green-fg">if</span> num_batches <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">0</span> <span class="ansi-green-fg">and</span> limit_eval_batches <span class="ansi-blue-fg">&gt;</span> <span class="ansi-cyan-fg">0.0</span> <span class="ansi-green-fg">and</span> isinstance<span class="ansi-blue-fg">(</span>limit_eval_batches<span class="ansi-blue-fg">,</span> float<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    267 </span><span class="ansi-red-fg">                    </span>min_pct <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">1.0</span> <span class="ansi-blue-fg">/</span> len<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    268 </span><span class="ansi-red-fg">                    raise MisconfigurationException(
</span>
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(274)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    272 </span><span class="ansi-red-fg">                    )
</span><span class="ansi-green-fg">    273 </span>
<span class="ansi-green-fg">--&gt; 274 </span><span class="ansi-red-fg">                </span>loader_num_batches<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>num_batches<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    275 </span>
<span class="ansi-green-fg">    276 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> loader_num_batches<span class="ansi-blue-fg">,</span> dataloaders

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(248)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    246 </span><span class="ansi-red-fg">        </span><span class="ansi-red-fg"># datasets could be none, 1 or 2+</span>
<span class="ansi-green-fg">    247 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">!=</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 248 </span><span class="ansi-red-fg">            </span><span class="ansi-green-fg">for</span> i<span class="ansi-blue-fg">,</span> dataloader <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>dataloaders<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    249 </span><span class="ansi-red-fg">                </span>num_batches <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> has_len<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> float<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;inf&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    250 </span><span class="ansi-red-fg">                </span>self<span class="ansi-blue-fg">.</span>_worker_check<span class="ansi-blue-fg">(</span>dataloader<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">f&#39;{mode} dataloader {i}&#39;</span><span class="ansi-blue-fg">)</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(276)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    274 </span><span class="ansi-red-fg">                </span>loader_num_batches<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>num_batches<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    275 </span>
<span class="ansi-green-fg">--&gt; 276 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> loader_num_batches<span class="ansi-blue-fg">,</span> dataloaders
<span class="ansi-green-fg">    277 </span>
<span class="ansi-green-fg">    278 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> reset_val_dataloader<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> model<span class="ansi-blue-fg">:</span> LightningModule<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--Return--
([4], [&lt;torch.utils....x7f4d57382b20&gt;])
&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(276)<span class="ansi-cyan-fg">_reset_eval_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    274 </span><span class="ansi-red-fg">                </span>loader_num_batches<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>num_batches<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    275 </span>
<span class="ansi-green-fg">--&gt; 276 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> loader_num_batches<span class="ansi-blue-fg">,</span> dataloaders
<span class="ansi-green-fg">    277 </span>
<span class="ansi-green-fg">    278 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> reset_val_dataloader<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> model<span class="ansi-blue-fg">:</span> LightningModule<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--Return--
None
&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/data_loading.py</span>(287)<span class="ansi-cyan-fg">reset_val_dataloader</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    285 </span><span class="ansi-red-fg">        </span>has_step <span class="ansi-blue-fg">=</span> is_overridden<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;validation_step&#39;</span><span class="ansi-blue-fg">,</span> model<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    286 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> has_loader <span class="ansi-green-fg">and</span> has_step<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 287 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>num_val_batches<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>val_dataloaders <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_reset_eval_dataloader<span class="ansi-blue-fg">(</span>model<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;val&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    288 </span>
<span class="ansi-green-fg">    289 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> reset_test_dataloader<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> model<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/trainer.py</span>(721)<span class="ansi-cyan-fg">run_sanity_check</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    719 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> should_sanity_check<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    720 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>reset_val_dataloader<span class="ansi-blue-fg">(</span>ref_model<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 721 </span><span class="ansi-red-fg">            self.num_sanity_val_batches = [
</span><span class="ansi-green-fg">    722 </span><span class="ansi-red-fg">                </span>min<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>num_sanity_val_steps<span class="ansi-blue-fg">,</span> val_batches<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> val_batches <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>num_val_batches
<span class="ansi-green-fg">    723 </span><span class="ansi-red-fg">            ]
</span>
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/trainer.py</span>(722)<span class="ansi-cyan-fg">run_sanity_check</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    720 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>reset_val_dataloader<span class="ansi-blue-fg">(</span>ref_model<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    721 </span><span class="ansi-red-fg">            self.num_sanity_val_batches = [
</span><span class="ansi-green-fg">--&gt; 722 </span><span class="ansi-red-fg">                </span>min<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>num_sanity_val_steps<span class="ansi-blue-fg">,</span> val_batches<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> val_batches <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>num_val_batches
<span class="ansi-green-fg">    723 </span><span class="ansi-red-fg">            ]
</span><span class="ansi-green-fg">    724 </span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/trainer.py</span>(721)<span class="ansi-cyan-fg">run_sanity_check</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    719 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> should_sanity_check<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    720 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>reset_val_dataloader<span class="ansi-blue-fg">(</span>ref_model<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 721 </span><span class="ansi-red-fg">            self.num_sanity_val_batches = [
</span><span class="ansi-green-fg">    722 </span><span class="ansi-red-fg">                </span>min<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>num_sanity_val_steps<span class="ansi-blue-fg">,</span> val_batches<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> val_batches <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>num_val_batches
<span class="ansi-green-fg">    723 </span><span class="ansi-red-fg">            ]
</span>
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py:851: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)
  return torch.tensor(x, **format_kwargs)
/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py:851: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)
  return torch.tensor(x, **format_kwargs)
/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py:851: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)
  return torch.tensor(x, **format_kwargs)
/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py:851: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)
  return torch.tensor(x, **format_kwargs)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(29)<span class="ansi-cyan-fg">validation_step</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     27 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> validation_step<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> batch<span class="ansi-blue-fg">,</span> batch_idx<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     28 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">import</span> pdb<span class="ansi-blue-fg">;</span> pdb<span class="ansi-blue-fg">.</span>set_trace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 29 </span><span class="ansi-red-fg">        </span>loss <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>forward<span class="ansi-blue-fg">(</span>batch<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     30 </span><span class="ansi-red-fg">        </span>self<span class="ansi-blue-fg">.</span>log<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;val_loss&#39;</span><span class="ansi-blue-fg">,</span> loss<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     31 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> loss

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor(10.6027)
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--Call--
&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(16)<span class="ansi-cyan-fg">forward</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     14 </span>
<span class="ansi-green-fg">     15 </span>
<span class="ansi-green-fg">---&gt; 16 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> forward<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     17 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">import</span> pdb<span class="ansi-blue-fg">;</span> pdb<span class="ansi-blue-fg">.</span>set_trace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     18 </span><span class="ansi-red-fg">        </span>loss <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;input_ids&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> attention_mask<span class="ansi-blue-fg">=</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;attention_mask&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> labels<span class="ansi-blue-fg">=</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;input_ids&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(17)<span class="ansi-cyan-fg">forward</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     15 </span>
<span class="ansi-green-fg">     16 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> forward<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 17 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">import</span> pdb<span class="ansi-blue-fg">;</span> pdb<span class="ansi-blue-fg">.</span>set_trace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     18 </span><span class="ansi-red-fg">        </span>loss <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;input_ids&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> attention_mask<span class="ansi-blue-fg">=</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;attention_mask&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> labels<span class="ansi-blue-fg">=</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;input_ids&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">     19 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> loss

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(18)<span class="ansi-cyan-fg">forward</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     16 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> forward<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     17 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">import</span> pdb<span class="ansi-blue-fg">;</span> pdb<span class="ansi-blue-fg">.</span>set_trace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 18 </span><span class="ansi-red-fg">        </span>loss <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;input_ids&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> attention_mask<span class="ansi-blue-fg">=</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;attention_mask&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> labels<span class="ansi-blue-fg">=</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;input_ids&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">     19 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> loss
<span class="ansi-green-fg">     20 </span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(19)<span class="ansi-cyan-fg">forward</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     17 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">import</span> pdb<span class="ansi-blue-fg">;</span> pdb<span class="ansi-blue-fg">.</span>set_trace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     18 </span><span class="ansi-red-fg">        </span>loss <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;input_ids&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> attention_mask<span class="ansi-blue-fg">=</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;attention_mask&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> labels<span class="ansi-blue-fg">=</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;input_ids&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">---&gt; 19 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> loss
<span class="ansi-green-fg">     20 </span>
<span class="ansi-green-fg">     21 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> training_step<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> batch<span class="ansi-blue-fg">,</span> batch_idx<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--Return--
tensor(10.6027)
&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(19)<span class="ansi-cyan-fg">forward</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     17 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">import</span> pdb<span class="ansi-blue-fg">;</span> pdb<span class="ansi-blue-fg">.</span>set_trace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     18 </span><span class="ansi-red-fg">        </span>loss <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;input_ids&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> attention_mask<span class="ansi-blue-fg">=</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;attention_mask&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> labels<span class="ansi-blue-fg">=</span>x<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;input_ids&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">---&gt; 19 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> loss
<span class="ansi-green-fg">     20 </span>
<span class="ansi-green-fg">     21 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> training_step<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> batch<span class="ansi-blue-fg">,</span> batch_idx<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(30)<span class="ansi-cyan-fg">validation_step</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     28 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">import</span> pdb<span class="ansi-blue-fg">;</span> pdb<span class="ansi-blue-fg">.</span>set_trace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     29 </span><span class="ansi-red-fg">        </span>loss <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>forward<span class="ansi-blue-fg">(</span>batch<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 30 </span><span class="ansi-red-fg">        </span>self<span class="ansi-blue-fg">.</span>log<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;val_loss&#39;</span><span class="ansi-blue-fg">,</span> loss<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     31 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> loss
<span class="ansi-green-fg">     32 </span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(31)<span class="ansi-cyan-fg">validation_step</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     29 </span><span class="ansi-red-fg">        </span>loss <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>forward<span class="ansi-blue-fg">(</span>batch<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     30 </span><span class="ansi-red-fg">        </span>self<span class="ansi-blue-fg">.</span>log<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;val_loss&#39;</span><span class="ansi-blue-fg">,</span> loss<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 31 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> loss
<span class="ansi-green-fg">     32 </span>
<span class="ansi-green-fg">     33 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> validation_epoch_end<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> losses<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--Return--
tensor(10.6027)
&gt; <span class="ansi-green-fg">&lt;ipython-input-3-69e7a89dc66e&gt;</span>(31)<span class="ansi-cyan-fg">validation_step</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     29 </span><span class="ansi-red-fg">        </span>loss <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>forward<span class="ansi-blue-fg">(</span>batch<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     30 </span><span class="ansi-red-fg">        </span>self<span class="ansi-blue-fg">.</span>log<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;val_loss&#39;</span><span class="ansi-blue-fg">,</span> loss<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 31 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> loss
<span class="ansi-green-fg">     32 </span>
<span class="ansi-green-fg">     33 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> validation_epoch_end<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> losses<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/accelerators/cpu_accelerator.py</span>(59)<span class="ansi-cyan-fg">_step</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     57 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     58 </span><span class="ansi-red-fg">            </span>output <span class="ansi-blue-fg">=</span> model_step<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 59 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> output
<span class="ansi-green-fg">     60 </span>
<span class="ansi-green-fg">     61 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> training_step<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--Return--
tensor(10.6027)
&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/accelerators/cpu_accelerator.py</span>(59)<span class="ansi-cyan-fg">_step</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     57 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     58 </span><span class="ansi-red-fg">            </span>output <span class="ansi-blue-fg">=</span> model_step<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 59 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> output
<span class="ansi-green-fg">     60 </span>
<span class="ansi-green-fg">     61 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> training_step<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--Return--
tensor(10.6027)
&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/accelerators/cpu_accelerator.py</span>(65)<span class="ansi-cyan-fg">validation_step</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     63 </span>
<span class="ansi-green-fg">     64 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> validation_step<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 65 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_step<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>trainer<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">.</span>validation_step<span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     66 </span>
<span class="ansi-green-fg">     67 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> test_step<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/usr/local/lib/python3.8/dist-packages/pytorch_lightning/trainer/evaluation_loop.py</span>(183)<span class="ansi-cyan-fg">evaluation_step</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    181 </span>
<span class="ansi-green-fg">    182 </span><span class="ansi-red-fg">        </span><span class="ansi-red-fg"># capture any logged information</span>
<span class="ansi-green-fg">--&gt; 183 </span><span class="ansi-red-fg">        </span>self<span class="ansi-blue-fg">.</span>trainer<span class="ansi-blue-fg">.</span>logger_connector<span class="ansi-blue-fg">.</span>cache_logged_metrics<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">    184 </span><span class="ansi-red-fg">        </span><span class="ansi-red-fg"># track batch size for weighted average</span>
<span class="ansi-green-fg">    185 </span><span class="ansi-red-fg">        </span>is_result_obj <span class="ansi-blue-fg">=</span> isinstance<span class="ansi-blue-fg">(</span>output<span class="ansi-blue-fg">,</span> Result<span class="ansi-blue-fg">)</span>

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">basic_model</span><span class="o">.</span><span class="n">train_ds</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

